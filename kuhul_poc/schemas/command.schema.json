{
  "$schema": "xjson://schema/core/v1",
  "$id": "kuhul://schema/command/v1",
  "@type": "xjson.schema",
  "@status": "frozen",
  "title": "KUHUL Command Schema v1",
  "type": "object",
  "additionalProperties": false,
  "required": ["@type", "@v", "id", "ts_ms", "source", "op", "args"],
  "properties": {
    "@type": { "const": "kuhul.command" },
    "@v": { "type": "string", "pattern": "^[0-9]+\\.[0-9]+\\.[0-9]+$" },
    "id": { "type": "string", "minLength": 8, "maxLength": 64 },
    "ts_ms": { "type": "integer", "minimum": 0 },
    "source": {
      "type": "object",
      "additionalProperties": false,
      "required": ["kind", "session"],
      "properties": {
        "kind": { "enum": ["cli", "gui", "ai", "api", "test"] },
        "who": { "type": "string" },
        "session": { "type": "string", "minLength": 3, "maxLength": 128 }
      }
    },
    "op": { "type": "string", "minLength": 3, "maxLength": 128 },
    "args": { "type": "object" }
  },
  "oneOf": [
    {
      "required": ["op", "args"],
      "properties": {
        "op": { "const": "ui.create" },
        "args": {
          "type": "object",
          "additionalProperties": false,
          "required": ["component", "props"],
          "properties": {
            "component": { "enum": ["button", "card", "chat-bubble"] },
            "props": {
              "type": "object",
              "additionalProperties": false,
              "properties": {
                "text": { "type": "string" },
                "label": { "type": "string" }
              }
            }
          }
        }
      }
    },
    {
      "required": ["op", "args"],
      "properties": {
        "op": { "const": "ui.theme.apply" },
        "args": {
          "type": "object",
          "additionalProperties": false,
          "required": ["name"],
          "properties": {
            "name": { "enum": ["dark", "light"] }
          }
        }
      }
    },
    {
      "required": ["op", "args"],
      "properties": {
        "op": { "const": "svg.export" },
        "args": {
          "type": "object",
          "additionalProperties": false,
          "required": ["hint"],
          "properties": {
            "hint": { "type": "string" }
          }
        }
      }
    },
    {
      "required": ["op", "args"],
      "properties": {
        "op": { "const": "shell.intent" },
        "args": {
          "type": "object",
          "additionalProperties": false,
          "required": ["intent", "shell"],
          "properties": {
            "intent": { "type": "string" },
            "shell": { "enum": ["bash", "dom", "quake", "sql", "kuhul"] }
          }
        }
      }
    }
  ]
}
